<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a generator function — generator • coro</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a generator function — generator" />
<meta property="og:description" content="generator() creates an generator factory. A generator is an
iterator function that can pause its execution with
yield() and resume from where it left off. Because they manage
state for you, generators are the easiest way to create
iterators. See vignette(&quot;generator&quot;).
The following rules apply:
Yielded values do not terminate the generator. If you call the
generator again, the execution resumes right after the yielding
point. All local variables are preserved.
Returned values terminate the generator. If called again after a
return(), the generator keeps returning the exhausted()
sentinel.


Generators are compatible with all features based on the iterator
protocol such as loop() and collect()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/generator.html">Generators</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-lib/coro/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a generator function</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-lib/coro/blob/master/R/generator.R'><code>R/generator.R</code></a></small>
    <div class="hidden name"><code>generator.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>generator()</code> creates an generator factory. A generator is an
<a href='iterator.html'>iterator function</a> that can pause its execution with
<code><a href='yield.html'>yield()</a></code> and resume from where it left off. Because they manage
state for you, generators are the easiest way to create
iterators. See <code><a href='../articles/generator.html'>vignette("generator")</a></code>.</p>
<p>The following rules apply:</p><ul>
<li><p>Yielded values do not terminate the generator. If you call the
generator again, the execution resumes right after the yielding
point. All local variables are preserved.</p></li>
<li><p>Returned values terminate the generator. If called again after a
<code><a href='https://rdrr.io/r/base/function.html'>return()</a></code>, the generator keeps returning the <code><a href='iterator.html'>exhausted()</a></code>
sentinel.</p></li>
</ul>

<p>Generators are compatible with all features based on the iterator
protocol such as <code><a href='collect.html'>loop()</a></code> and <code><a href='collect.html'>collect()</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>generator</span><span class='op'>(</span><span class='va'>fn</span><span class='op'>)</span>

<span class='fu'>gen</span><span class='op'>(</span><span class='va'>expr</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fn</th>
      <td><p>A function template for generators. The function can
<code><a href='yield.html'>yield()</a></code> values. Within a generator, <code>for</code> loops have
<a href='iterator.html'>iterator</a> support.</p></td>
    </tr>
    <tr>
      <th>expr</th>
      <td><p>A yielding expression.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='yield.html'>yield()</a></code>, <code><a href='coro_debug.html'>coro_debug()</a></code> for step-debugging.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='co'># A generator statement creates a generator factory. The</span></span>
<span class='r-in'><span class='co'># following generator yields two times and then returns `"c"`:</span></span>
<span class='r-in'><span class='va'>generate_abc</span> <span class='op'>&lt;-</span> <span class='fu'>generator</span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='fu'><a href='yield.html'>yield</a></span><span class='op'>(</span><span class='st'>"a"</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='fu'><a href='yield.html'>yield</a></span><span class='op'>(</span><span class='st'>"b"</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='st'>"c"</span></span>
<span class='r-in'><span class='op'>}</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Or equivalently:</span></span>
<span class='r-in'><span class='va'>generate_abc</span> <span class='op'>&lt;-</span> <span class='fu'>generator</span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>x</span> <span class='kw'>in</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>    <span class='fu'><a href='yield.html'>yield</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='op'>}</span></span>
<span class='r-in'><span class='op'>}</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># The factory creates generator instances. They are iterators</span></span>
<span class='r-in'><span class='co'># that you can call successively to obtain new values:</span></span>
<span class='r-in'><span class='va'>abc</span> <span class='op'>&lt;-</span> <span class='fu'>generate_abc</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>abc</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "a"</span>
<span class='r-in'><span class='fu'>abc</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "b"</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Once a generator has returned it keeps returning `exhausted()`.</span></span>
<span class='r-in'><span class='co'># This signals to its caller that new values can no longer be</span></span>
<span class='r-in'><span class='co'># produced. The generator is exhausted:</span></span>
<span class='r-in'><span class='fu'>abc</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "c"</span>
<span class='r-in'><span class='fu'>abc</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> exhausted</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># You can only exhaust a generator once but you can always create</span></span>
<span class='r-in'><span class='co'># new ones from a factory:</span></span>
<span class='r-in'><span class='va'>abc</span> <span class='op'>&lt;-</span> <span class='fu'>generate_abc</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>abc</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "a"</span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># As generators implement the coro iteration protocol, you can use</span></span>
<span class='r-in'><span class='co'># coro tools like `loop()`. It makes it possible to loop over</span></span>
<span class='r-in'><span class='co'># iterators with `for` expressions:</span></span>
<span class='r-in'><span class='fu'><a href='collect.html'>loop</a></span><span class='op'>(</span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>x</span> <span class='kw'>in</span> <span class='va'>abc</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "b"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "c"</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># To gather values of an iterator in a list, use `collect()`. Pass</span></span>
<span class='r-in'><span class='co'># the `n` argument to collect that number of elements from a</span></span>
<span class='r-in'><span class='co'># generator:</span></span>
<span class='r-in'><span class='va'>abc</span> <span class='op'>&lt;-</span> <span class='fu'>generate_abc</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='collect.html'>collect</a></span><span class='op'>(</span><span class='va'>abc</span>, <span class='fl'>1</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "a"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Or drain all remaining elements:</span></span>
<span class='r-in'><span class='fu'><a href='collect.html'>collect</a></span><span class='op'>(</span><span class='va'>abc</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "b"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[2]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "c"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># coro provides a short syntax `gen()` for creating one-off</span></span>
<span class='r-in'><span class='co'># generator _instances_. It is handy to adapt existing iterators:</span></span>
<span class='r-in'><span class='va'>numbers</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span></span>
<span class='r-in'><span class='va'>odds</span> <span class='op'>&lt;-</span> <span class='fu'>gen</span><span class='op'>(</span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>x</span> <span class='kw'>in</span> <span class='va'>numbers</span><span class='op'>)</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>x</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span> <span class='fl'>2</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='fu'><a href='yield.html'>yield</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>squares</span> <span class='op'>&lt;-</span> <span class='fu'>gen</span><span class='op'>(</span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>x</span> <span class='kw'>in</span> <span class='va'>odds</span><span class='op'>)</span> <span class='fu'><a href='yield.html'>yield</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>greetings</span> <span class='op'>&lt;-</span> <span class='fu'>gen</span><span class='op'>(</span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>x</span> <span class='kw'>in</span> <span class='va'>squares</span><span class='op'>)</span> <span class='fu'><a href='yield.html'>yield</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Hey"</span>, <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='collect.html'>collect</a></span><span class='op'>(</span><span class='va'>greetings</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[1]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Hey 1"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[2]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Hey 9"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[3]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Hey 25"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[4]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Hey 49"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [[5]]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "Hey 81"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Arguments passed to generator instances are returned from the</span></span>
<span class='r-in'><span class='co'># `yield()` statement on reentry:</span></span>
<span class='r-in'><span class='va'>new_tally</span> <span class='op'>&lt;-</span> <span class='fu'>generator</span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='va'>count</span> <span class='op'>&lt;-</span> <span class='fl'>0</span></span>
<span class='r-in'>  <span class='kw'>while</span> <span class='op'>(</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>    <span class='va'>i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='yield.html'>yield</a></span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span></span>
<span class='r-in'>    <span class='va'>count</span> <span class='op'>&lt;-</span> <span class='va'>count</span> <span class='op'>+</span> <span class='va'>i</span></span>
<span class='r-in'>  <span class='op'>}</span></span>
<span class='r-in'><span class='op'>}</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>tally</span> <span class='op'>&lt;-</span> <span class='fu'>new_tally</span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>tally</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0</span>
<span class='r-in'><span class='fu'>tally</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 2</span>
<span class='r-in'><span class='fu'>tally</span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 12</span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Lionel Henry.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


